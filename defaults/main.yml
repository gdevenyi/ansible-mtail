---
# defaults file for roles/mtail

# where to download compiled mtail binary
mtail_archive_url: "https://github.com/google/mtail/releases/download/v3.0.0-rc46/mtail_3.0.0-rc46_Linux_x86_64.tar.gz"

# checksum argument to be used with ansible's get_url
# note: must match file content downloaded from URL given with mtail_archive_url
mtail_checksum: "sha256:c257fe113bd922ace4183522d2c29d33f657fbe269c81058f2bc692dbf3f2761"

# where to install the mtail executable
mtail_exec: "/usr/local/sbin/mtail"

# name of service (e.g. systemd unit)
mtail_service_name: "mtail"

# system user and group to run mtail as
mtail_service_user: "{{ mtail_service_name }}"
mtail_service_uid: "3903"
mtail_service_group: "{{ mtail_service_user }}"
mtail_service_gid: "{{ mtail_service_uid }}"

# where to write log messages, empty string redirects logs to stderr
#mtail_logdir: "/var/log/{{ mtail_service_name }}"
mtail_logdir: ""

# TCP port used for the HTTP server
mtail_port: "3903"

# log files to monitor
mtail_logs:
  - "/var/log/messages"

# list of Jinja2 templates files to install as mtail programs
mtail_programs: []
  
# directory path where mtail programs are located
mtail_progs: "/etc/mtail"

# all mtail arguments except -logs
mtail_args:
  - "-port {{ mtail_port }}"
  - "-progs {{ mtail_progs }}"
  - "-syslog_use_current_year"
  - "{{ '-log_dir '+mtail_logdir if mtail_logdir else '-logtostderr' }}"

# whether AppArmor profile should be created
mtail_apparmor_enabled: "{{ ansible_apparmor.status == 'enabled' }}"

# AppArmor profile name
mtail_apparmor_profile: "{{ mtail_exec[1:] | replace('/', '.') }}"

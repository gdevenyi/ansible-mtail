---
# defaults file for roles/mtail

# where to download compiled mtail binary
mtail_binary_url: "https://github.com/google/mtail/releases/download/v3.0.0-rc35/mtail_v3.0.0-rc35_linux_amd64"

# checksum argument to be used with ansible's get_url
# note: must match file content downloaded from URL given with mtail_binary_url
mtail_checksum: "sha256:f2b4a8e8db6c06b8fa1d17c71334fc5a7e5e9bc4c8d60a9560b664b30218b6ac"

# where to install the mtail executable
mtail_exec: "/usr/local/sbin/mtail"

# name of service (e.g. systemd unit)
mtail_service_name: "mtail"

# system user and group to run mtail as
mtail_service_user: "{{ mtail_service_name }}"
mtail_service_uid: "3903"
mtail_service_group: "{{ mtail_service_user }}"
mtail_service_gid: "{{ mtail_service_uid }}"

# where to write log messages, empty string redirects logs to stderr
#mtail_logdir: "/var/log/{{ mtail_service_name }}"
mtail_logdir: ""

# where to write log messages
mtail_log_arg: "{{ '-log_dir '+mtail_logdir if mtail_logdir else '-logtostderr' }}"

# TCP port used for the HTTP server
mtail_port: "3903"

# log files to monitor
mtail_logs:
  - "/var/log/messages"

# list of Jinja2 templates files to install as mtail programs
mtail_programs: []
  
# directory path where mtail programs are located
mtail_progs: "/etc/mtail"

# all mtail arguments except -logs
mtail_args:
  - "-port {{ mtail_port }}"
  - "-progs {{ mtail_progs }}"
  - "-syslog_use_current_year"
  - "{{ mtail_log_arg }}"

# whether AppArmor profile should be created
mtail_apparmor_enabled: "{{ ansible_apparmor.status == 'enabled' }}"

# AppArmor profile name
mtail_apparmor_profile: "{{ mtail_exec[1:] | replace('/', '.') }}"
